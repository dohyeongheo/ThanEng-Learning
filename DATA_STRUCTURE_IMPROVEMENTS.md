# 데이터 구조 개선 제안

현재 `data.json` 파일은 약 193KB 크기로 30일치의 학습 데이터를 포함하고 있습니다.

## 현재 구조의 장단점

### 장점
- ✅ 단순하고 직관적
- ✅ JSON 파싱이 빠름
- ✅ 브라우저에서 직접 로드 가능
- ✅ 버전 관리 용이

### 단점
- ❌ 파일이 커질수록 로딩 시간 증가
- ❌ 필요한 Day만 로드 불가능
- ❌ 부분 업데이트 어려움
- ❌ 메모리 사용량 증가

## 개선 방안

### 방안 1: 분리된 파일 구조 (추천)

각 Day별로 별도 파일로 분리

```
data/
  ├── day-1.json
  ├── day-2.json
  ├── ...
  └── day-30.json
```

**장점:**
- 필요한 Day만 로드 가능 (Lazy Loading)
- 파일 크기 감소 (각 파일 약 6-7KB)
- 부분 업데이트 용이
- 병렬 로딩 가능

**단점:**
- 파일 관리 복잡도 증가
- HTTP 요청 수 증가 (하지만 병렬 로딩으로 해결 가능)

**구현 예시:**
```javascript
async function loadDay(day) {
    const response = await fetch(`data/day-${day}.json`);
    return await response.json();
}

// 필요한 Day만 로드
const day1Data = await loadDay(1);
```

---

### 방안 2: 압축된 형식

JSON을 압축하여 전송

**장점:**
- 파일 크기 대폭 감소 (약 50-70% 감소)
- 네트워크 대역폭 절약

**단점:**
- 브라우저에서 압축 해제 필요
- 서버 설정 필요 (gzip/brotli)

**구현:**
- 서버에서 자동으로 gzip 압축 (대부분의 서버가 지원)
- 또는 JSON을 MessagePack 같은 바이너리 형식으로 변환

---

### 방안 3: IndexedDB 사용

브라우저 내장 데이터베이스 활용

**장점:**
- 오프라인 완벽 지원
- 빠른 검색 및 쿼리
- 대용량 데이터 처리 가능
- 인덱싱으로 빠른 검색

**단점:**
- 초기 설정 복잡
- 브라우저 호환성 고려 필요
- 데이터 동기화 필요

**구현 예시:**
```javascript
// IndexedDB에 데이터 저장
const db = await openDB('thaieng-db', 1);
await db.put('words', data);

// 검색
const results = await db.getAllFromIndex('words', 'meaning', '안녕');
```

---

### 방안 4: API 기반 구조

백엔드 API로 데이터 제공

**장점:**
- 실시간 업데이트 가능
- 사용자별 맞춤 데이터
- 분석 및 통계 수집 가능
- 보안 강화

**단점:**
- 서버 필요
- 개발 및 운영 비용
- 오프라인 지원 어려움

---

### 방안 5: 하이브리드 접근 (최적)

**초기 로드:** 메타데이터만 로드 (Day 목록)
**필요 시:** 각 Day 데이터를 개별 로드

```
data/
  ├── index.json          # Day 목록 및 메타데이터만
  ├── day-1.json
  ├── day-2.json
  └── ...
```

**index.json 예시:**
```json
{
  "days": [
    {
      "id": 1,
      "topic": "생존 & 요청",
      "thCount": 10,
      "enCount": 8
    },
    ...
  ]
}
```

**장점:**
- 빠른 초기 로딩
- 필요한 데이터만 로드
- 확장성 좋음
- 캐싱 전략 용이

---

## 추천 구현 순서

1. **1단계: 분리된 파일 구조** (가장 간단하고 효과적)
   - 각 Day를 별도 파일로 분리
   - Lazy Loading 구현
   - 기존 JSON 구조 유지

2. **2단계: 압축 추가**
   - 서버에서 gzip 압축 활성화
   - 추가 코드 변경 없음

3. **3단계: IndexedDB 도입** (선택사항)
   - 오프라인 지원 강화 필요 시
   - 검색 성능 개선 필요 시

## 현재 구조 유지 시 개선 사항

현재 구조를 유지하면서 개선할 수 있는 방법:

1. **데이터 최적화**
   - 불필요한 공백 제거
   - 중복 데이터 제거
   - 키 이름 단축 (예: `topic` → `t`, `thai` → `th`)

2. **로딩 최적화**
   - 현재 구현된 캐싱 활용
   - ETag 기반 업데이트 (이미 구현됨)
   - 압축 활성화

3. **점진적 로딩**
   - 첫 화면에는 Day 목록만 표시
   - 클릭 시 해당 Day 데이터 로드

## 결론

**현재 상황 (193KB):**
- ✅ 충분히 작은 크기
- ✅ 단일 파일로 관리 용이
- ✅ 현재 구조 유지 가능

**향후 확장 시:**
- 📁 분리된 파일 구조로 전환 권장
- 📦 압축 활성화
- 💾 IndexedDB 고려 (오프라인 강화 시)

